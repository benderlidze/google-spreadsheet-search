<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <title>Document</title>
</head>

<body>

    <script>
        const empty = [];
        let GEO = [];
        let main = [];

        d3.csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vSJcIvuQLMyyQhZbiFjYgS76gaIrp0v-NufzLCgAAh63M_5493YspVJDlK66K-t2WAZy_JxaOXlfu1x/pub?output=csv")
            .then(data => {
                console.log('data', data);
                /*
                const n = data.length;
                (async () => {
                    for (let index = 0; index < n; index++) {

                        const { Address, Email, Name, Phone, Town, ZIP } = data[index]

                        const addr = `${Address}, ${Town}, ${ZIP}`
                        console.log('addr', addr);

                        await fetch(`https://maps.googleapis.com/maps/api/geocode/json?&address=${addr}&key=AIzaSyA02Kd0Hr22YiGrFkeMi5n_ekmph0BsbqY`)
                            .then(i => i.json())
                            .then(res => {
                                console.log('res', res);
                                if(res.status!== "ZERO_RESULTS"){
                                    GEO.push([Name, Address, ZIP, Town, Phone, Email, res.results[0].geometry.location.lat, res.results[0].geometry.location.lng])
                                }else{
                                    GEO.push([Name, Address, ZIP, Town, Phone, Email])
                                }
                            })
                    }
                })();
                /**/
                console.log('RESULTS: ', GEO);

            })

        const timer = ms => new Promise(res => setTimeout(res, ms))
    </script>
</body>

</html>